import { db } from "../db";
import { 
  users, 
  projects, 
  services, 
  testimonials, 
  siteSettings, 
  paymentMethods,
  type InsertUser,
  type InsertProject,
  type InsertService,
  type InsertTestimonial,
  type InsertSiteSettings,
  type InsertPaymentMethod
} from "../../shared/schema";
import { hashPassword } from "../auth";

async function seedDatabase() {
  console.log("üå± Iniciando seed do banco de dados...");

  try {
    // Criar usu√°rio admin
    console.log("üë§ Criando usu√°rio admin...");
    const adminPassword = await hashPassword("admin123");
    
    const adminUser: InsertUser = {
      username: "admin",
      password: adminPassword,
      name: "Admin",
      email: "admin@seucodigo.com",
      role: "admin"
    };

    await db.insert(users).values(adminUser);
    console.log("‚úÖ Usu√°rio admin criado");

    // Criar usu√°rios de teste
    console.log("üë• Criando usu√°rios de teste...");
    const testPassword = await hashPassword("cliente123");
    
    const testUsers: InsertUser[] = [
      {
        username: "cliente1",
        password: testPassword,
        name: "Jo√£o Silva",
        email: "joao@email.com",
        role: "user"
      },
      {
        username: "cliente2",
        password: testPassword,
        name: "Maria Santos",
        email: "maria@email.com",
        role: "user"
      }
    ];

    await db.insert(users).values(testUsers);
    console.log("‚úÖ Usu√°rios de teste criados");

    // Criar servi√ßos
    console.log("üõ†Ô∏è Criando servi√ßos...");
    const servicesData: InsertService[] = [
      {
        title: "Desenvolvimento Web Full-Stack",
        description: "Cria√ß√£o de aplica√ß√µes web completas com React, Node.js e PostgreSQL. Solu√ß√µes modernas e responsivas para seu neg√≥cio.",
        category: "Desenvolvimento Web",
        technologies: ["React", "Node.js", "PostgreSQL"],
        image: "https://images.unsplash.com/photo-1461749280684-dccba630e2f6?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        price: 2500,
        imageUrl: "https://images.unsplash.com/photo-1461749280684-dccba630e2f6?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        featured: true,
        status: "active"
      },
      {
        title: "Aplicativos Mobile Nativos",
        description: "Desenvolvimento de apps nativos para iOS e Android com React Native. Performance e experi√™ncia do usu√°rio excepcionais.",
        category: "Mobile",
        technologies: ["React Native", "iOS", "Android"],
        image: "https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        price: 3500,
        imageUrl: "https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        featured: true,
        status: "active"
      },
      {
        title: "E-commerce Personalizado",
        description: "Lojas virtuais completas com carrinho, pagamentos, gest√£o de produtos e dashboard administrativo.",
        category: "E-commerce",
        technologies: ["React", "Stripe", "PayPal"],
        image: "https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        price: 4000,
        imageUrl: "https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        featured: true,
        status: "active"
      },
      {
        title: "Consultoria em Tecnologia",
        description: "Orienta√ß√£o t√©cnica para projetos, arquitetura de software e escolha das melhores tecnologias para seu neg√≥cio.",
        category: "Consultoria",
        technologies: ["Arquitetura", "Planejamento", "Tecnologia"],
        image: "https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        price: 200,
        imageUrl: "https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        featured: false,
        status: "active"
      },
      {
        title: "Manuten√ß√£o e Suporte",
        description: "Suporte t√©cnico cont√≠nuo para suas aplica√ß√µes, corre√ß√µes de bugs e implementa√ß√£o de melhorias.",
        category: "Suporte",
        technologies: ["Manuten√ß√£o", "Debugging", "Otimiza√ß√£o"],
        image: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        price: 150,
        imageUrl: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        featured: false,
        status: "active"
      },
      {
        title: "Integra√ß√£o de APIs",
        description: "Conecte suas aplica√ß√µes com sistemas externos, pagamentos, notifica√ß√µes e muito mais.",
        category: "Desenvolvimento Web",
        technologies: ["REST API", "GraphQL", "Webhooks"],
        image: "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        price: 800,
        imageUrl: "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        featured: false,
        status: "active"
      }
    ];

    await db.insert(services).values(servicesData);
    console.log("‚úÖ Servi√ßos criados");

    // Criar projetos
    console.log("üöÄ Criando projetos...");
    const projectsData: InsertProject[] = [
      {
        title: "E-commerce Responsivo",
        description: "Loja virtual completa com carrinho de compras, sistema de pagamento integrado e painel administrativo. Desenvolvida com React e Node.js.",
        category: "E-commerce",
        image: "https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        technologies: ["React", "Node.js", "PostgreSQL", "Stripe"],
        githubUrl: "https://github.com/seucodigo/ecommerce-project",
        liveUrl: "https://ecommerce-demo.seucodigo.com",
        featured: true,
        status: "active"
      },
      {
        title: "Aplicativo de Gest√£o Financeira",
        description: "App mobile para controle financeiro pessoal com gr√°ficos, relat√≥rios e sincroniza√ß√£o na nuvem.",
        category: "Mobile",
        image: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        technologies: ["React Native", "Firebase", "Chart.js"],
        githubUrl: "https://github.com/seucodigo/finance-app",
        liveUrl: "https://finance-app.seucodigo.com",
        featured: true,
        status: "active"
      },
      {
        title: "Portal Institucional",
        description: "Website institucional moderno com CMS personalizado, otimizado para SEO e totalmente responsivo.",
        category: "Desenvolvimento Web",
        image: "https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        technologies: ["Next.js", "Tailwind CSS", "Prisma"],
        githubUrl: "https://github.com/seucodigo/institutional-site",
        liveUrl: "https://institutional.seucodigo.com",
        featured: true,
        status: "active"
      },
      {
        title: "Sistema de Reservas Online",
        description: "Plataforma completa para agendamento de servi√ßos com calend√°rio interativo e notifica√ß√µes autom√°ticas.",
        category: "Desenvolvimento Web",
        image: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        technologies: ["Vue.js", "Express", "MongoDB"],
        githubUrl: "https://github.com/seucodigo/booking-system",
        liveUrl: "https://booking.seucodigo.com",
        featured: false,
        status: "active"
      },
      {
        title: "App de Delivery",
        description: "Aplicativo de delivery com rastreamento em tempo real, sistema de pagamento e avalia√ß√µes.",
        category: "Mobile",
        image: "https://images.unsplash.com/photo-1586816001966-79b736744398?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        technologies: ["React Native", "Socket.io", "Redis"],
        githubUrl: "https://github.com/seucodigo/delivery-app",
        liveUrl: "https://delivery.seucodigo.com",
        featured: false,
        status: "active"
      },
      {
        title: "Dashboard Analytics",
        description: "Painel de controle com m√©tricas em tempo real, gr√°ficos interativos e relat√≥rios customiz√°veis.",
        category: "Desenvolvimento Web",
        image: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&h=400",
        technologies: ["React", "D3.js", "GraphQL"],
        githubUrl: "https://github.com/seucodigo/analytics-dashboard",
        liveUrl: "https://analytics.seucodigo.com",
        featured: false,
        status: "active"
      }
    ];

    await db.insert(projects).values(projectsData);
    console.log("‚úÖ Projetos criados");

    // Criar depoimentos
    console.log("üí¨ Criando depoimentos...");
    const testimonialsData: InsertTestimonial[] = [
      {
        name: "Ricardo Oliveira",
        company: "CEO, TechSolutions",
        avatar: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=50&h=50",
        message: "Contratei o desenvolvimento do site da minha empresa e fiquei impressionado com a qualidade e agilidade do servi√ßo. O resultado final superou todas as expectativas!",
        rating: 5
      },
      {
        name: "Ana Beatriz",
        company: "Propriet√°ria, Moda&Estilo",
        avatar: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=50&h=50",
        message: "O desenvolvimento do nosso e-commerce foi executado com extremo profissionalismo. A plataforma √© est√°vel, r√°pida e muito f√°cil de administrar. Altamente recomendado!",
        rating: 5
      },
      {
        name: "Carlos Mendes",
        company: "Co-fundador, AppNova",
        avatar: "https://images.unsplash.com/photo-1522075469751-3a6694fb2f61?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=50&h=50",
        message: "O aplicativo que desenvolveram para nossa startup foi fundamental para nosso crescimento. A interface √© intuitiva e os usu√°rios adoram a experi√™ncia. O suporte p√≥s-entrega tamb√©m foi excelente.",
        rating: 4
      },
      {
        name: "Fernanda Costa",
        company: "Gerente, Distribuidora Express",
        avatar: "https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=50&h=50",
        message: "Precis√°vamos de um sistema de gest√£o personalizado e o resultado foi perfeito. Atenderam todas as nossas necessidades espec√≠ficas e o sistema √© muito f√°cil de usar. Excelente custo-benef√≠cio!",
        rating: 5
      },
      {
        name: "Roberto Lima",
        company: "Diretor, Consultoria Empresarial",
        avatar: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=50&h=50",
        message: "A consultoria t√©cnica que recebemos foi fundamental para definir a arquitetura do nosso produto. Conhecimento t√©cnico s√≥lido e orienta√ß√µes muito pr√°ticas. Recomendo sem hesita√ß√£o!",
        rating: 5
      },
      {
        name: "Juliana Rodrigues",
        company: "Fundadora, EcoVerde",
        avatar: "https://images.unsplash.com/photo-1580489944761-15a19d654956?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=50&h=50",
        message: "O site institucional que criaram para nossa empresa de sustentabilidade ficou lindo e totalmente alinhado com nossos valores. A navega√ß√£o √© fluida e o design √© moderno. Muito satisfeita!",
        rating: 5
      }
    ];

    await db.insert(testimonials).values(testimonialsData);
    console.log("‚úÖ Depoimentos criados");

    // Criar configura√ß√µes do site
    console.log("‚öôÔ∏è Criando configura√ß√µes do site...");
    const siteSettingsData: InsertSiteSettings = {
      siteName: "SeuCodigo",
      siteTitle: "Desenvolvimento Web & Aplica√ß√µes M√≥veis",
      siteDescription: "Transformamos suas ideias em solu√ß√µes digitais inovadoras. Especialistas em desenvolvimento web, aplica√ß√µes m√≥veis e consultoria em tecnologia.",
      contactEmail: "contato@seucodigo.com",
      contactPhone: "+55 11 99999-9999",
      socialMedia: {
        github: "https://github.com/seucodigo",
        linkedin: "https://linkedin.com/company/seucodigo",
        instagram: "https://instagram.com/seucodigo",
        twitter: "https://twitter.com/seucodigo"
      },
      themeColor: "#00ffff",
      logo: "https://images.unsplash.com/photo-1611224923853-80b023f02d71?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=100&h=100"
    };

    await db.insert(siteSettings).values(siteSettingsData);
    console.log("‚úÖ Configura√ß√µes do site criadas");

    // Criar m√©todos de pagamento
    console.log("üí≥ Criando m√©todos de pagamento...");
    const paymentMethodsData: InsertPaymentMethod[] = [
      {
        name: "PIX",
        provider: "pix",
        isActive: true,
        config: {
          pixKey: "contato@seucodigo.com",
          pixKeyType: "email",
          merchantName: "SeuCodigo Desenvolvimento",
          merchantCity: "S√£o Paulo"
        }
      },
      {
        name: "Cart√£o de Cr√©dito",
        provider: "stripe",
        isActive: true,
        config: {
          publishableKey: "pk_test_51234567890abcdef",
          webhookSecret: "whsec_test_123456"
        }
      }
    ];

    await db.insert(paymentMethods).values(paymentMethodsData);
    console.log("‚úÖ M√©todos de pagamento criados");

    console.log("üéâ Seed conclu√≠do com sucesso!");
    console.log("\nüìä Dados criados:");
    console.log("- 3 usu√°rios (1 admin + 2 clientes)");
    console.log("- 6 servi√ßos");
    console.log("- 6 projetos");
    console.log("- 6 depoimentos");
    console.log("- 1 configura√ß√£o do site");
    console.log("- 2 m√©todos de pagamento");
    console.log("\nüîë Credenciais de acesso:");
    console.log("Admin: admin / admin123");
    console.log("Cliente: cliente1 / cliente123");
    console.log("Cliente: cliente2 / cliente123");

  } catch (error) {
    console.error("‚ùå Erro durante o seed:", error);
    throw error;
  }
}

// Executar seed se chamado diretamente
if (import.meta.url === `file://${process.argv[1]}`) {
  seedDatabase()
    .then(() => {
      console.log("‚úÖ Processo finalizado");
      process.exit(0);
    })
    .catch((error) => {
      console.error("‚ùå Falha no seed:", error);
      process.exit(1);
    });
}

export { seedDatabase };